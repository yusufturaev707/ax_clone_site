{% load i18n %}
{% load static %}

<form method="post" id="editExpertPermissionForm" data-url="{% url 'edit_expert_permission' expert.pk %}">
    {% csrf_token %}
    <div class="modal fade" id="edit_expert_permission_modal" tabindex="-1" role="dialog" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 class="modal-title">{{ expert.user.last_name }} {{ expert.user.first_name }} {{ expert.user.middle_name }}</h3>
                    <a href="#" class="close" data-dismiss="modal">&times;</a>
                </div>
                <div class="modal-body">
                    <div class="container">
                        <h3 class="text text-center text-success">{% trans "Ruxsatlarni o'zgartirish" %}</h3><br>
                        <div class="form-group row">
                            <div class="col-sm-10">
                                <p class="m-b-25">
                                    <input type="checkbox" {% if expert.is_sender %} checked {% endif %}
                                           data-render="switchery" data-theme="default" id="id_is_sender{{ expert.id }}"
                                           name="is_sender{{ expert.id }}"/><label
                                        for="id_is_sender{{ expert.id }}">
                                    &nbsp;{% trans "Savollarni yuborish ruxsati" %}</label>
                                </p>
                            </div>
                        </div>
                        <div class="form-group row">
                            <div class="col-sm-10">
                                <p class="m-b-25">
                                    <input type="checkbox" {% if expert.is_checker %} checked {% endif %}
                                           data-render="switchery" data-theme="default"
                                           id="id_is_checker{{ expert.id }}" name="is_checker{{ expert.id }}"/><label
                                        for="id_is_checker{{ expert.id }}">
                                    &nbsp;{% trans "Savollarni tekshirish ruxsati" %}</label>
                                </p>
                            </div>
                        </div>
                    </div>
                    <br>
                    <button type="submit" class="btn btn-success btn-block btn-md">{% trans "Saqlash" %}</button>
                    <button type="button" class="btn btn-outline-dark btn-block btn-sm"
                            data-dismiss="modal">{% trans "Yopish" %}</button>
                </div>
            </div>
        </div>
    </div>
</form>
<script src="{% static '/assets/js/demo/form-slider-switcher.demo.js' %}"></script>
<script>
     $(document).ready(function () {
         $("body").on('submit', '#editExpertPermissionForm', function (e) {
             e.preventDefault();

             let form_url = $(this).data('url');
             let formData = $('#editExpertPermissionForm')
             
             $.ajax({
                 type: "POST",
                 url: form_url,
                 data: formData.serialize(),
                 dataType: "json",
                 success: function (response) {
                     let status = response['result'];
                     if (status === 200){
                         window.location.reload();
                     }
                     if (status === 500){
                         alert(response['message'])
                     }
                 },
                 error: function (error) {
                        console.log(error);
                    },
             })
         })
     })
</script>